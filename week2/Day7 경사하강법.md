# Day7 경사하강법

## 미분

- 변수의 움직임에 따른 함수값의 변화를 측정하기 위한 도구
- 접선의 기울기 (변화율)
- 한 점에서 접선의 기울기를 알면 어느 방향으로 점을 움직여야 함수값이 증가/감소 하는지 알 수 있음
    - 증가 시키고 싶다면 +미분값 , 감소 시키고 싶다면 -미분값
    - 미분값이 음수라면 x + f'(x) < x는 왼쪽으로 이동하여 함수값 증가
    - 미분값이 양수라면 x + f'(x) > x는 오른쪽으로 이동하여 함수값 증가
- 미분값을 더하면 경사상승법 → 함수의 극대값의 위치를 구할 때 사용
- 미분값을 빼면 경사하강법 → 함수의 극소값의 위치를 구할 때 사용

## 경사하강법

- 접선의 기울기를 구해 점을 어느 방향으로 움직여야 할지 알아내어 함수 값 감소 시킴
- 극값에서 미분값이 0이 되면 더 이상 업데이트 X
- 벡터가 입력인 다변수 함수의 경우 편미분을 사용
    - 각 변수 별로 편미분을 계산한 그래디언트 벡터를 이용하여 경사하강/경사상승법에 사용
        - 역삼각형은 nabla: 다변수를 입력으로 가지는 함수의 그래디언트 벡터를 표시하는 기호
        - 경사하강법 알고리즘을 그대로 사용하지만 벡터에 절대값 대신 norm을 사용해서 종료조건 설정

    ![Untitled](https://user-images.githubusercontent.com/73166743/105842959-549e2a80-601a-11eb-84a4-4fc503269b48.png)

![Untitled 1](https://user-images.githubusercontent.com/73166743/105842941-4f40e000-601a-11eb-9a1b-1fb4cfb2940f.png)

![Untitled 2](https://user-images.githubusercontent.com/73166743/105842947-50720d00-601a-11eb-9711-5ced5b0b0626.png)

- 그레디언트 벡터
    - 그레디언트 벡터는 각 점 (x, y)에서 임의의 점에서 가장 빨리 증가하는 방향으로 흐름0

        (마이너스라면 감소)

        ![Untitled 3](https://user-images.githubusercontent.com/73166743/105842952-50720d00-601a-11eb-9f4e-435f88666612.png)

- 경사하강법으로 선형회귀 계수 구하기
    - 선형회귀식의 목적식은 ||y - Xb||2 이고 이를 최소화하는 b(베타)를 찾아야 하므로 다음과 같은 그레디언트 벡터를 구해야 한다.
    - 목적식을 b(베타)로 미분한 다음 주어진 b에서 미분값을 뻬주어 경사하강법 알고리즘을 최소에 해당하는 점을 구할 수 O
    - 0일 때까지 아니라 지정한 횟수 만큼만 학습하게 할 수도 O
    - 볼록(convex)한 함수에 대해선 적절한 학습률과 학습횟수를 선택했을 때 수렴이 보장됨

![Untitled 4](https://user-images.githubusercontent.com/73166743/105842953-536cfd80-601a-11eb-9266-d5cc6d8f60bb.png)

![Untitled 5](https://user-images.githubusercontent.com/73166743/105842954-54059400-601a-11eb-9c26-4fb867d55b50.png)

- 비선형회귀 문제에서의 경사하강법 ⇒ SGD
    - SGD: 확률적 경사하강법
    - 모든 데이터를 사용해서 업데이트 하는 대신 데이터 한개 또는 일부를 활용하여 업데이트

        → mini batch sgd

    - SGD는 데이터의 일부를 가지고 파라미터를 업데이트하기 때문에 연산자원을 더 효율적으로 활용
    - 미니배치는 확률적으로 선택하므로 목적식 모양이 바뀜(곡선 모양 변함) → 극소점 탈출 가능, 방향 비슷

    ![Untitled 6](https://user-images.githubusercontent.com/73166743/105842957-54059400-601a-11eb-851d-03750641e156.png)

